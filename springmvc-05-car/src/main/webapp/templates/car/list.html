<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<link th:href="@{/static/bootstrap/css/bootstrap.min.css}"
	rel="stylesheet">
<title>车辆列表</title>
		<style type="text/css">
			.carPage{
				text-align:center;
			}
		</style>
	</head>
	<body>
		<h2>车辆列表</h2>
		
		<div class="container-fluid">
			<div class="row" id="carList">
			
			</div>
		</div>
		<div class="carPage" >
			<button id="firstPage" class="btn btn-primary" type="button">首页</button>
			<button id="prePage" class="btn btn-success" type="button">上一页</button>
			<button id="nextPage" class="btn btn-info" type="button">下一页</button>
			<button id="lastPage" class="btn btn-danger" type="button">尾页</button>
		</div>
		
	
	
	
<script th:src="@{/static/js/jquery/jquery-3.4.1.js}" type="text/javascript"></script>
<script th:src="@{/static/bootstrap/js/bootstrap.min.js}" type="text/javascript"></script>
<script th:inline="javascript" type="text/javascript"> 
	const path = /*[[${#request.getContextPath()}]]*/ 
	
	let currentPage = 1;
	let pageCount = '';
	
	$(function(){
		et1911.queryList();
		
		$('#firstPage').click(function(){
			et1911.queryList();
		});
		$('#prePage').click(function(){
			et1911.queryList(--currentPage);
		});
		$('#nextPage').click(function(){
			et1911.queryList(++currentPage);
		});
		$('#lastPage').click(function(){
			et1911.queryList(pageCount);
		});
		
	});
	
	
	let et1911={
		queryList:function(pageNum,pageSize){
			pageNum = pageNum || 1
			pageSize = pageSize || 8
			
			$.ajax({
				url:path+'/car/list',
				type:'GET',
				data:'pageNum='+pageNum+'&pageSize='+pageSize,
				dataType:'json',
				success:function(res){
					currentPage = res.pageNum;
					pageCount = res.pageCount;
					let divs = '';
					$.each(res.rows,function(index,car){
						divs += "<div class='col-md-3'>"
							 +"<img class='img-thumbnail' src='" + path + car.pic + "'>"
							 +"<p>"+car.brand+"/"+car.series+"</p>"
							 +"<p>"+car.price+"万元</p>"
							 +"<p>"+car.gearbox+"</p>"
							 +"</div>"
					})
					$('#carList').html(divs);
					
					if(res.first){
						$('#firstPage').attr('disabled','disabled')
						$('#prePage').attr('disabled','disabled')						
					}else{
						$('#firstPage').removeAttr('disabled')
						$('#prePage').removeAttr('disabled')
					}
					if(res.last){
						$('#lastPage').attr('disabled','disabled')
						$('#nextPage').attr('disabled','disabled')		
					}else{
						$('#lastPage').removeAttr('disabled')
						$('#nextPage').removeAttr('disabled')
					}
				}
			})
		}
	}
	
</script>


</body>
</html>